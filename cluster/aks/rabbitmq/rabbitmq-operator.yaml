environments:
  default:
    values:
      - ../params.yaml
      -
        self:
          namespace: unique

---


releases:
  - name: rabbitmq-cluster-operator
    createNamespace: true
    namespace: {{ .Values.self.namespace }}
    chart: oci://registry-1.docker.io/bitnamicharts/rabbitmq-cluster-operator
    version: 4.3.21
    wait: false
    values:
      - global:
          defaultStorageClass: default-zrs
        clusterOperator:
          image:
            registry: {{ .Values.plain.registryUrl }}
            repository: bitnami/rabbitmq-cluster-operator
            tag: "2.10.0-debian-12-r0"
          nodeSelector:
            scalability: steady
            lifecycle: persistent
          watchAllNamespaces: false
          # watchNamespaces: #TODO
          #   - unique
          resources:
            # Matches 'nano' Preset which is the default
            # https://github.com/bitnami/charts/blob/main/bitnami/common/templates/_resources.tpl#L15
            requests:
              cpu: 100m
              ephemeral-storage: 50Mi
              memory: 128Mi
            limits:
              cpu: 150m
              ephemeral-storage: 2Gi
              memory: 192Mi
        msgTopologyOperator:
          image:
            registry: {{ .Values.plain.registryUrl }}
            repository: bitnami/rmq-messaging-topology-operator
            tag: "1.14.2-debian-12-r5"
          nodeSelector:
            scalability: steady
            lifecycle: persistent
          # Matches 'nano' Preset which is the default
          # https://github.com/bitnami/charts/blob/main/bitnami/common/templates/_resources.tpl#L15
          resources:
            requests:
              cpu: 100m
              ephemeral-storage: 50Mi
              memory: 128Mi
            limits:
              cpu: 150m
              ephemeral-storage: 2Gi
              memory: 192Mi
